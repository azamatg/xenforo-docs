+++
title = "Синтаксис шаблонов XenForo 2.x"
menutitle = "Синтаксис шаблонов"
draft = false
layout = "single"
weight = 2
page_author = "official"
page_progress = "25"
show_progress = "true"
+++

{{% bq class="success" %}}Перевод официальной документации - статья <a href="https://github.com/xenforo-ltd/docs/blob/master/docs/template-syntax.md">Template syntax</a>{{% /bq %}}

Синтаксис шаблонов XenForo 2 - мощный инструмент как для разработчиков, так и для администраторов, который дает полный контроль над внешним видом страниц вашего форума.

## Лучшие практики

- Все теги XenForo, по соглашению, пишем в `нижнем регистре`.
- Все теги шаблонов XenForo имеют префикс `xf:`.

## Полезная информация

### Комментарии в шаблонах

Используйте тег `xf:comment`, чтобы закомментировать в шаблоне строки кода или какой-то текст. Все, что будет внутри этого тега, не будет отображено в скомпилированном шаблоне (итоговом HTML).

```html
<xf:comment>
Очень полезный комментарий, но он не будет выведен в итоговый HTML, так что вы можете прочитать его только здесь, при редактировании этого шаблона.
</xf:comment>
```

### Подключение другого шаблона внутри текущего

Используйте тег `xf:include`, чтобы подключить другой шаблон в текущий шаблон.

```html
<xf:include template="my_template" />
```

Параметр `template` принимает имя нужного шаблона.

## Макросы в шаблонах

> Этот раздел требует уточнения перевода.

Макросы - один из самых мощных инструментов синтаксиса шаблонов XenForo.

Если сильно упростить описание, то можно сказать, что макросы нужно применять там, где шаблон требует сложной логики, повторения каких-то элементов и шаблонов, в разных местах и с разными задачами. Более подробно логику внедрения и работы макросов можно изучить в исходниках :)

Внимание!

- Для сохранения "читабельности" шаблонов, не используйте тег макроса как переменную. Вместо этого используйте тег `set` и используйте макрос как переменную шаблона.
- Если макрос используется более чем в одном файле, будет логичным сделать для него отдельный шаблон.

### Определение макроса

В самом простом (минимально допустимом) случае макрос может быть определен, как указано в примере ниже - нужно задать имя макроса в параметре `name` и прописать контент самого макроса.

```html
<xf:macro
    name="my_macro_name">

    <!-- Your macro content -->

</xf:macro>
```

### Аргументы макроса

```html
<xf:macro
    name="my_macro_name"
    arg-message="My amazing macro message!">

    <h1>Message</h1>
    <p>{$message}</p>

</xf:macro>
```

В этом примере мы определили параметр `arg-message` и назначили ему значение по умолчанию (текст `My amazing macro message!`). Если макрос будет вызван без аргументов, `arg-message` будет содержать это значение по умолчанию, иначе значение параметра будет перезаписано значением параметра макроса, вызванного с заданием значения этого параметра.

Иногда требуется задать параметр, как обязательный - для этого в определении макроса в значении параметра по умолчанию пишем символ `!`.

### Использование и включение макросов в шаблон

```html
<xf:macro template="my_macro_template" name="my_macro_name" />
```

В этом простом примере мы вызываем макрос с указанием его имени в параметре `name` и указанием шаблона макроса в параметре `my_macro_template`.

*Внимание!* 

- **Определение** макроса производится внутри **обоих** тегов `xf:macro` - открывающего (`<xf:macro>`)и закрывающего (`</xf:macro>`).
- **Вызов** макроса производится **одиночным** тегом `<xf:macro ... />` (обратите внимание на закрывающие скобки).

#### Аргументы макроса при вызове

```html
<xf:macro template="my_macro_template" name="my_macro_name" arg-argName="argValue" />
```

`argName` - имя аргумента.

*Внимание!* Называйте аргументы в стиле `lowerCamelCase`.


## Контроль структуры шаблонов

Синтаксис шаблонов XenForo 2 предоставляет достаточно возможностей для контроля структуры шаблонов.


### Тег IF

Тег `if` используется для ограничения/вывода частей шаблона по заданным условиям.

```html
<!-- Показать контент юзеру только если он залогинен... -->
<xf:if is="$xf.visitor.user_id">
    <!-- Показать что-то... -->
</xf:if>
```

Тег `IF` принимает один атрибут:

- `is` - условие, согласно которому содержимое будет/не будет отображаться.

#### Условия

Атрибут `is` принимает следующие логические операторы:

- `OR` - оператор `ИЛИ` (также можно использовать `||`)
- `AND` - оператор `И` (также можно использовать `&&`)
- `!` - оператор `НЕ` (инверсия условия)
- `XOR` - оператор `ОДНО ИЗ`, возвращает `true` если только одно из условий верное

#### ELSE / ELSEIF

Теги `else` и `elseif` используются только совместно с тегом `if` для более разнообразной логики в шаблонах.

##### Пример использования тега ELSE

```html
<xf:if is="$xf.visitor.is_admin">
    <!-- Этот контент будет отображен только администраторам... -->
<xf:else />
    <!-- Иначе (если текущий юзер не администратор) данный контент будет показан всем остальным -->
</xf:if>
```

##### Пример использования тега ELSEIF

```html
<xf:if is="$xf.visitor.is_admin">
    <!-- Этот контент будет отображен только администраторам... -->
<xf:elseif is="$xf.visitor.is_moderator" />
    <!-- Этот контент будет отображен только модераторам (но не администраторам)... -->
<xf:else />
    <!-- Этот контент будет отображет всем, кто не является администратором или модератором... -->
</xf:if>
```

Обратите внимание, что когда одно из условий в списке выполняется, все последующие условия будут проигнорированы. В примере выше, если юзер - администратор, выполнится первое условие, а все следующие будут проигнорированы (не будут проверяться).

### Тег FOREACH

Тег `foreach` повзволяет перебирать массивы, и выводить, к примеру, определенный HTML для каждого элемента.  

##### Атрибуты тега FOREACH

- `loop` - массив с данными
- `key` - имя переменной для вывода ключа текущего элемента массива (содержимое этой переменной будет целым число для простых массивов, и строкой для именованных), для числовых ключей отсчет идет с нуля
- `value` - имя переменной для вывода значения текущего элемента массива
- `i` - имя хранения для вывода индекса текущего элемента массива (отсчет индекса идет с единицы)

#### Пример простого FOREACH

```html
<xf:set var="$names" value="{{ ['Patrick', 'Theresa', 'Kimball', 'Wayne', 'Grace'] }}" />

<xf:foreach loop="$names" key="$key" value="$name" i="$i">
    <p>Hello there, {$name}. This is name number {$i}. Array key of this element: {$key}</p>
</xf:foreach>

```

В этом примере мы перебираем массив `$names`, и выводим для каждого элемента массива заданный html-код.

Результат вывода массива (в виде html-кода):

```html
<p>Hello there, Patrick. This is name number 1. Array key of this element: 0</p>
<p>Hello there, Theresa. This is name number 2. Array key of this element: 1</p>
<p>Hello there, Kimball. This is name number 3. Array key of this element: 2</p>
<p>Hello there, Wayne. This is name number 4. Array key of this element: 3</p>
<p>Hello there, Grace. This is name number 5. Array key of this element: 4</p>
```

## Список тегов в шаблонах

Для удобства и сокращения страницы мы сделали отдельный раздел - [Список тегов в шаблонах](/template/tags/), здесь же приводим сводную таблицу этих тегов.

{{% section_inner_pages_by_section_path name="Тег" path="/template/tags" %}}

## Ссылки

- [Оригинал статьи](https://github.com/xenforo-ltd/docs/blob/master/docs/template-syntax.md)