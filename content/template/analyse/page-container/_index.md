+++
title = "Анализ шаблона PAGE_CONTAINER"
menutitle = "PAGE_CONTAINER"
short_desc = "PAGE_CONTAINER - основной (корневой) шаблон всего форума"
date = 2018-11-06T21:57:19+05:00
draft = "false"
layout = "single"
content_type = "template_analyse"
page_author = "me"
page_progress = "6"
show_progress = "true"
+++

{{% bq class="success" %}}Основной (корневой) шаблон `PAGE_CONTAINER` отвечает за структуру всей страницы.{{% /bq %}}

## Введение 

Этот шаблон является основным "скелетом" внешнего вида всего форума. Внутри него в зависимости от контекста (какая страница просматривается сейчас).

В этом (и во многих других шаблонах) активно используется глобальная переменная `$xf`, рекомендуется внимательно изучить ее вывод на всех доступных страницах, чтобы видеть, какие параметры доступны в ней в зависимости от контекста.

Чтобы получить на странице дамп этой (и любой другой переменной) в удобочитаемом виде, вызовите в корневом шаблоне команду

```html
{{ dump($xf) }}
```

## Раздел HEAD

В этом разделе формируются различные мета-теги и подключаются файлы CSS, JS.

```html
<!DOCTYPE html>
<html id="XF"
    lang="{$xf.language.language_code}" 
    dir="{$xf.language.text_direction}"
	data-app="public"
	data-template="{$template}"
	data-container-key="{$containerKey}"
	data-content-key="{$contentKey}"
	data-logged-in="{{ $xf.visitor.user_id ? 'true' : 'false' }}"
	data-cookie-prefix="{$xf.cookie.prefix}"
	class="has-no-js{{ $template ? ' template-' . $template : '' }}"
	{{ $xf.runJobs ? ' data-run-jobs=""' : '' }}>
...
```

В теге `html` задаются следующие параметры:

{{% table_class %}}
| Параметр | Источник | Описание |
| --- | --- | --- |
| `lang` | глобальная переменная `$xf.language.language_code` | Язык страницы в формате `ru_RU`, задается в настройках форума (*Настройки - Внешний вид - Язык, используемый по умолчанию)*. |
| `dir` | глобальная переменная `$xf.language.text_direction` | Направление чтения в формате `LTR`, задается настройками самого языка (*Внешний вид - Языки - Редактировать язык*), актуально для языков типа иврита или арабского. |
| `data-app` | сам шаблон | Контекст приложения, `public` - публичная часть форума, `admin` - админка. |
| `data-template` | контекстная переменная `$template` | Название шаблона текущего контекста, например `thread_view` будет выведено при просмотре конкретной темы форума. Это довольно удобный параметр для отладки, хотя можно сделать и дамп переменной `$template` в самом шаблоне. |
| `data-container-key` | контекстная переменная `$containerKey` | Если открыт форум или тема в данном форуме, здесь будет выведен ключ (ID) этого форума в формате `node-349`, где `349` - ID форума. При просмотре других страниц (типа страницы юзера) этот параметр будет пустым. |
| `data-content-key` | Контекстная переменная `$contentKey` | Если открыта конкретная тема, здесь будет выведен ключ (ID) этой темы в формате `thread-14370`, где `14370` - ID этой темы. |
| `data-logged-in` | простая проверка на ID посетителя | Будет выведено `true`, если посетитель залогинен (юзер), иначе `false` (гость). |
| `data-cookie-prefix` | `$xf.cookie.prefix` | Префикс для названия кукисов, которые форум выставляет текущему посетителю, задается в `config.php`. |
| `class` | Простая проверка на название шаблона | Добавляется класс типа `template-thread_view`, где `thread_vew` - название текущего шаблона страницы (см. параметр выше - `data-template`). |
{{% /table_class %}}


Также в шаблоне назначается обработка текущих запланированных задач, это делает команда `$xf.runJobs`. По сути, это "крон для бедных" - когда на хостинге нет нормального крона, и планировщик форума вынужден полагаться на посетителей, которые будут триггером для запуска какой-нибудь запланированной задачи, ждущей своей очереди.
